{"version":3,"sources":["../../../widgets/Xunta/Widget.js"],"names":["define","declare","BaseWidget","QueryTask","Query","lang","SpatialReference","Graphic","SimpleFillSymbol","Color","SimpleLineSymbol","baseClass","postCreate","inherited","arguments","console","log","cargaConcellos","codigoProvincia","selectProvincia","value","selectConcellos","innerHTML","queryTask","config","concellosService","query","returnGeometry","outFields","orderByFields","where","execute","hitch","results","opt","document","createElement","text","add","i","features","length","attributes","CODCONC","CONCELLO","cargaParroquias","codigoConcello","selectParroquias","parroquiasService","CODPARRO","PARROQUIA","zoomConcello","outSpatialReference","geom","geometry","map","graphics","clear","STYLE_SOLID","setExtent","getExtent","zoomParroquia","codigoParroquia"],"mappings":"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","file":"Widget.js","sourcesContent":["define(['dojo/_base/declare', 'jimu/BaseWidget',\"esri/tasks/QueryTask\",\"esri/tasks/query\",\"dojo/_base/lang\",\"esri/SpatialReference\",\"esri/graphic\",\"esri/symbols/SimpleFillSymbol\",\"esri/Color\",\"esri/symbols/SimpleLineSymbol\"],\r\nfunction(declare, BaseWidget,QueryTask,Query,lang,SpatialReference,Graphic,SimpleFillSymbol,Color,SimpleLineSymbol) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'xunta',\r\n    // this property is set by the framework when widget is loaded.\r\n    // name: 'Xunta',\r\n    // add additional properties here\r\n\r\n    //methods to communication with app container:\r\n    postCreate: function() {\r\n      this.inherited(arguments);\r\n      console.log('Xunta::postCreate');\r\n\r\n      },\r\n    cargaConcellos() {\r\n\r\n      let codigoProvincia = this.selectProvincia.value;\r\n      if(codigoProvincia == -1) return;\r\n\r\n      this.selectConcellos.innerHTML = \"\";\r\n\r\n      const queryTask = new QueryTask(this.config.concellosService);\r\n\r\n      const query = new Query();\r\n      query.returnGeometry = false;\r\n      query.outFields = [\"CODCONC\",\"CONCELLO\"];\r\n      query.orderByFields = [\"CONCELLO\"];\r\n      query.where= \"CODPROV =\"+ codigoProvincia;\r\n\r\n      queryTask.execute(query,lang.hitch(this,function(results){\r\n        let opt = document.createElement(\"option\");\r\n        opt.value = -1;\r\n        opt.text = \"Seleccione concello\";\r\n        this.selectConcellos.add(opt);\r\n        for (let i=0; i <results.features.length; i++){\r\n          opt = document.createElement(\"option\");\r\n          opt.value = results.features[i].attributes.CODCONC;\r\n          opt.text = results.features[i].attributes\r\n          .CONCELLO;\r\n          this.selectConcellos.add(opt);\r\n        }\r\n\r\n        \r\n      }\r\n      ))\r\n      \r\n      },\r\n      cargaParroquias(){\r\n        let codigoConcello = this.selectConcellos.value;\r\n      if(codigoConcello == -1) return;\r\n\r\n      this.selectParroquias.innerHTML = \"\";\r\n\r\n      const queryTask = new QueryTask(this.config.parroquiasService);\r\n\r\n      const query = new Query();\r\n      query.returnGeometry = false;\r\n      query.outFields = [\"CODPARRO\",\"PARROQUIA\"];\r\n      query.orderByFields = [\"PARROQUIA\"];\r\n      query.where= \"CODCONC =\"+ codigoConcello;\r\n\r\n      queryTask.execute(query,lang.hitch(this,function(results){\r\n        let opt = document.createElement(\"option\");\r\n        opt.value = -1;\r\n        opt.text = \"Seleccione parroquia\";\r\n        this.selectParroquias.add(opt);\r\n\r\n        for (let i=0; i <results.features.length; i++){\r\n          opt = document.createElement(\"option\");\r\n          opt.value = results.features[i].attributes.CODPARRO;\r\n          opt.text = results.features[i].attributes\r\n          .PARROQUIA;\r\n          this.selectParroquias.add(opt);\r\n        }\r\n      }\r\n      ))\r\n\r\n      },\r\n      zoomConcello(){\r\n        let codigoConcello = this.selectConcellos.value;\r\n      if(codigoConcello == -1) return;\r\n\r\n      \r\n\r\n      const queryTask = new QueryTask(this.config.concellosService);\r\n\r\n      const query = new Query();\r\n      query.returnGeometry = true;\r\n      query.outFields = [\"CODCONC\",\"CONCELLO\"];\r\n      query.orderByFields = [\"CONCELLO\"];\r\n      query.where= \"CODCONC =\"+ codigoConcello;\r\n      query.outSpatialReference = new SpatialReference(102100)  \r\n      queryTask.execute(query,lang.hitch(this,function(results){\r\n        if(results.features.length>0){\r\n          let geom = results.features[0].geometry;\r\n          this.map.graphics.clear();\r\n          this.map.graphics.add(new Graphic(geom, new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID,\r\n            new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID,\r\n            new Color([1,1,1]), 2),new Color([1,1,1,0.25])\r\n        )))\r\n        this.map.setExtent(geom.getExtent(),true)\r\n        }\r\n      }))\r\n\r\n      },\r\n      zoomParroquia(){\r\n        let codigoParroquia = this.selectParroquias.value;\r\n        if(codigoParroquia == -1) return;\r\n  \r\n        \r\n  \r\n        const queryTask = new QueryTask(this.config.parroquiasService);\r\n  \r\n        const query = new Query();\r\n        query.returnGeometry = true;\r\n        query.outFields = [\"CODPARRO \",\"PARROQUIA \"];\r\n        query.orderByFields = [\"PARROQUIA\"];\r\n        query.where= \"CODPARRO =\"+ codigoParroquia;\r\n        query.outSpatialReference = new SpatialReference(102100)  \r\n        queryTask.execute(query,lang.hitch(this,function(results){\r\n          if(results.features.length>0){\r\n            let geom = results.features[0].geometry;\r\n            this.map.graphics.clear();\r\n            this.map.graphics.add(new Graphic(geom, new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID,\r\n              new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID,\r\n              new Color([100,100,100]), 2),new Color([100,100,100,0.25])\r\n          )))\r\n          this.map.setExtent(geom.getExtent(),true)\r\n          }\r\n        }))\r\n      }\r\n\r\n\r\n  });\r\n\r\n});\r\n"]}